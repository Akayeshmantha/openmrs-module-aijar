<htmlform formName="HMIS 055B HIV Counseling and Testing Client Card"
          formDescription="Client HIV Testing Card"
          formEncounterType="264daIZd-f80e-48fe-nba9-P37f2W1905Pv"
          formUuid="b5c62a98-84d3-43e8-a9be-972185070dd4"
          formVersion="1.2"
          formAddMetadata="yes"
          formUILocation="patientDashboard.visitActions"
          formOrder="6"
          formIcon="icon-medkit"
          formShowIf="visit.active &amp;&amp; patient.person.dead==false"
          formDisplayStyle="Standard"
          formLabel="HCT Client Card">
    <macros>
        headerColor =#8fabc7
        fontOnHeaderColor = white
    </macros>

    <style>

        form label, .form label {
        float: left;
        padding: 0px 10px 0 0;
        }

        form input[type="checkbox"], form input[type="radio"], .form input[type="checkbox"], .form input[type="radio"] {
        margin: 10px 15px;
        }

        table td{
        background: #FFFFFF;
        color: #404040;
        }

        form select, .form select {
        min-width: 0px;
        }

        form input, form select, form textarea, form ul.select, .form input, .form select, .form textarea, .form
        ul.select {
        background-color: #FBFBFB;
        border: 1px solid #CEC9C9;
        border-radius: 5px;
        margin-bottom: 10px;
        padding: 10px;
        min-width: 20%;
        }
        .row {
        width: 100%;
        float: left;
        display: inline-flex;
        clear: both;
        }

        .row .row-col2 {
        float: left;
        width: 50%;
        }

        table th, table td {
        border: 1px solid #C7C7C7;
        }
    </style>


    <script type="text/javascript">


        function enable_disable_fpm(enableDisable_fpmethod){

        var fp_combo = $(enableDisable_fpmethod).find('select');

        var selected_value = jQuery.trim(fp_combo.find(":selected").text());

        var disable = selected_value.toUpperCase()
        !="YES"
        $(".EnableDisablefpmethodchild").find("input").attr("disabled",disable );

        }

        function enable_disable_partner(enableDisable_partner){

        var fp_combo = $(enableDisable_partner).find('select');

        var selected_value = jQuery.trim(fp_combo.find(":selected").text());

        var disable = selected_value.toUpperCase()
        !="YES"
        $(".EnableDisablepartnerchild").find("input").attr("disabled",disable );

        }

        function enable_disable_GurdianConsent(enableDisable_GurdianConsent){

        var fp_combo = $(enableDisable_GurdianConsent).find('select');

        var selected_value = jQuery.trim(fp_combo.find(":selected").text());

        var disable = selected_value.toUpperCase()
        !="NO"
        $(".EnableDisableGurdianConsentchild").find("input").attr("disabled",disable );

        }


        if(jQuery){
        $(document).ready(function(){
        if ( $.browser.msie ) {
        $(":checkbox").click(function(){
        $(this).change();
        });
        }

        $("#comfirmedDate").change(function() {

        alert($(this).find("input[type$='text']").val() );

        });

        $('[class^="FamilyMemberEnableDisable"]').change(function() {
        enable_disable_fm($(this));
        });

        $('[class^="FamilyMemberEnableDisable"]').each(function(){
        enable_disable_fm( $(this));
        });


        $('[class^="ExposedInfantEnableDisable"]').change(function() {
        enable_disable_ei($(this));
        });


        $('[class^="ExposedInfantEnableDisable"]').each(function(){
        enable_disable_ei( $(this))
        });

        $('[class^="ArtCareEnableDisable"]').change(function() {
        enable_disable_ac($(this));
        });


        $('[class^="ArtCareEnableDisable"]').each(function(){
        enable_disable_ac( $(this))
        });

        $(".EnableDisablefpmethod").change(function() {

        enable_disable_fpm(this);

        });


        $(".EnableDisablefpmethod").each(function() {

        enable_disable_fpm(this);
        });


        $(".EnableDisablePatner").change(function() {

        enable_disable_Patner(this);

        });


        $(".EnableDisablePatner").each(function() {

        enable_disable_Patner(this);
        });


        $(".EnableDisableGurdianConsent").change(function() {

        enable_disable_GurdianConsent(this);

        });


        $(".EnableDisableGurdianConsent").each(function() {

        enable_disable_GurdianConsent(this);
        });


        $(".enableDisable").each(function(){
        var group = $(this);
        function disableFn(){
        group.children("#disabled").fadeTo(250,1);
        group.children("#disabled").find(":checkbox").attr("checked",false); //uncheck
        // group.children("#disabled").find("input[type$='text']").val("");
        group.children("#disabled").find("input").attr("disabled",true); //disable
        group.children("#disabled").find("select").attr("disabled",true);
        }
        function enableFn(){
        group.children("#disabled").fadeTo(250,1);
        group.children("#disabled").find("input").attr("disabled",false);
        group.children("#disabled").find("select").attr("disabled",false);

        }
        disableFn();
        $(this).children("#trigger").find(":checkbox:first").change(function(){
        var checked = $(this).attr("checked");
        if(checked == true){
        enableFn();
        }else{
        disableFn();
        }
        });
        });


        $(".checkboxGroup").each(function(){
        var group = $(this);
        var uncheckAll = function(){
        group.find("input[type$='checkbox']").attr("checked",false);
        group.find("input[type$='checkbox']").change();
        }
        var uncheckRadioAndAll = function(){
        group.find("#checkboxAll,#checkboxRadio").find("input[type$='checkbox']").attr("checked",false);
        group.find("#checkboxAll,#checkboxRadio").find("input[type$='checkbox']").change();
        }


        group.find("#checkboxAll").find("input").click(
        /* This was tricky... A number of things needed to happen
        Basically, This is supposed to treat a group of inputs as if
        were all one big checkbox. It is designed so that a checkbox
        can be next to an input, and the user clicks the input, the
        checkbox checks as well. But, when the user clicks the checkbox,
        the browser marks the checkbox as checked. Therefore, when we check
        if the checkbox is already checked, it always respondes true...
        We needed to have 2 cases: when the clicking action is on the first checkbox
        and when the action is on any other. */
        function(){
        var flip;
        var checked = $(this).siblings(":checkbox:first").attr("checked");
        if($(this).attr("name") == $(this).parents("#checkboxAll:first").find(":checkbox:first").attr("name")){
        checked = $(this).attr("checked");
        flip = checked;
        }else{
        flip = !checked;
        }
        if($(this).attr("type") == "text") if(flip == false) flip = !filp; // this is so the user doesn't go to check
        the checkbox, then uncheck it when they hit the input.
        uncheckAll();
        $(this).parents("#checkboxAll:first").find(":checkbox").attr("checked",flip);
        $(this).parents("#checkboxAll:first").find(":checkbox").change();
        }
        );


        group.find("#checkboxRadio").find("input[type$='checkbox']").click(function(){
        uncheckAll();
        $(this).siblings("input[type$='checkbox']").attr("checked",false);
        $(this).attr("checked",true);
        $(this).change();
        });

        group.find("#checkboxCheckbox").click(
        function(){
        uncheckRadioAndAll();
        }
        );
        });
        });
        }


    </script>
    <div class="ai-page-frame">
        <div class="headers" style="text-align: center;">
            <h3 style="background: #FFFF7D; padding: 10px;">HCT Client Card</h3>
        </div>
        <section>
            <h3>Section A:</h3>
            <table>
                <tbody>
                    <tr>
                        <td>
                            <label>Date:</label>
                            <encounterDate default="today"/>
                        </td>
                        <td>
                            <label>Point of Testing:</label>
                            <encounterLocation default="1"/>
                        </td>
                        <td>
                            <label>Center Type:</label>
                            <obs conceptId="99457" answerConceptIds="99455,99456" answerLabels="1. Static,2. Outreach"/>
                        </td>
                        <td>
                            <label>Reg Number:</label>
                            <patient field="identifier" identifierTypeId="c9e42035-7112-45b3-bfcf-4b37e1091dd4"
                                     required="true"/>
                        </td>
                    </tr>

                    <includeIf velocityTest="$patient.age &lt; 12">
                        <tr>   <td colspan="4">

                                <label>Accompanied by:</label>
                                <obs conceptId="99457" answerConceptIds="90012,90016,99363"
                                     answerLabels="Mother,Father, Guardian"/>
                            </td></tr>
                    </includeIf>

                </tbody>
            </table>
        </section>
        <section>
            <h3>Section B:</h3>
            <table class="section-b">
                <tbody>
                    <tr>
                        <td>
                            <label>Pre -Test Counseling done/information given:</label>
                        </td>
                        <td colspan="3">
                            <obs conceptId="162918" answerConceptIds="90003, 90004" answerLabels="Yes, No"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Counseled as:</label>
                        </td>
                        <td colspan="3">
                            <obs conceptId="99368" answerConceptIds="99365,99367,99366"
                                 answerLabels="Individual, Couple, Group"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Approach:</label>

                        </td>
                        <td colspan="3">
                            <obs conceptId="99462" answerConceptIds="162919,99459" answerLabels="CICT, PITC"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>HCT Entry Point:</label>

                        </td>
                        <td colspan="3">
                            <span id="checkboxRadio">
                                <obs conceptId="162925" answerConceptId="99416" answerLabel="Facility based"/>
                                <obs conceptId="162925" answerConceptId="162920" answerLabel="Work place"/>
                                <obs conceptId="162925" answerConceptId="162921" answerLabel="Comm/Out reach"/>
                                <obs conceptId="162925" answerConceptId="162922" answerLabel="HBHCT"/>
                                <obs conceptId="162925" answerConceptId="162923" answerLabel="Circumcision (SMC)"/>
                                <obs conceptId="162925" answerConceptId="99056" answerLabel="PEP"/>
                                <obs conceptId="162925" answerConceptId="90012" answerLabel="PMTCT"/>
                                <obs conceptId="162925" answerConceptId="162924" answerLabel="MARPS"/>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Have you ever tested for HIV before?:</label>

                        </td>
                        <td colspan="3">
                            <obs id="br" conceptId="99464" answerConceptIds="1065,1066" answerLabels="Yes,No"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                        </td>
                        <td style="background: #DADADA;">
                            <label>
                                <b>3 months</b>
                            </label>
                        </td>
                        <td style="background: #DADADA;">
                            <label>
                                <b>6 months</b>
                            </label>
                        </td>
                        <td style="background: #DADADA;">
                            <label>
                                <b>12 months</b>
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label style="float: right">
                               <i>Previously tested for HIV in last:</i>
                            </label>
                        </td>
                        <td>
                            <obs id="br" conceptId="99468" answerConceptId="99465" answerLabel=""/>
                        </td>
                        <td>
                            <obs id="br" conceptId="99468" answerConceptId="99466" answerLabel=""/>
                        </td>
                        <td>
                            <obs id="br" conceptId="99468" answerConceptId="99467" answerLabel=""/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label style="float: right">
                                <i>Test results in the last:</i>
                            </label>
                        </td>
                        <td>
                            <obs conceptId="99469" answerConceptIds="90167,90166" answerLabels="Negative,Positive"/>
                        </td>
                        <td>
                            <obs conceptId="99470" answerConceptIds="90167,90166" answerLabels="Negative,Positive"/>
                        </td>
                        <td>
                            <obs conceptId="99471" answerConceptIds="90167,90166" answerLabels="Negative,Positive"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Number of sexual partners in the last 12 months:</label>
                        </td>
                        <td colspan="3">
                            <obs conceptId="99463"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label>Has your spouse /partner been tested for HIV before? :</label>
                        </td>
                        <td colspan="3">
                            <obs id="br" conceptId="99472" answerConceptIds="1065,1066,99480"
                                 answerLabels="Yes,No,Don't Know"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label style="float:right;"><i>Category</i></label>
                        </td>
                        <td style="background: #DADADA;">
                            <label>
                                <b>
                                    <obs conceptId="99472" answerConceptId="90003" answerLabel="Spouse:"/>
                                </b>
                            </label>
                        </td>
                        <td style="background: #DADADA;">
                            <label>
                                <b>
                                    <obs conceptId="99473" answerConceptId="90003" answerLabel="Steady/Regular:"/>
                                </b>
                            </label>
                        </td>
                        <td style="background: #DADADA;">
                            <label>
                                <b>
                                    <obs conceptId="99474" answerConceptId="90003" answerLabel="Casual:"/>
                                </b>
                            </label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label style="float:right"><i>Test results</i></label>
                        </td>
                        <td>
                            <obs conceptId="99477" answerConceptIds="90166,90167,90001"
                                 answerLabels="HIV +ve,HIV -ve,Unknown"/>
                        </td>
                        <td>
                            <obs conceptId="99478" answerConceptIds="90166,90167,90001"
                                 answerLabels="HIV +ve,HIV -ve,Unknown"/>
                        </td>
                        <td>
                            <obs conceptId="99479" answerConceptIds="90166,90167,90001"
                                 answerLabels="HIV +ve,HIV -ve,Unknown"/>
                        </td>
                    </tr>

                </tbody>
            </table>
        </section>
        <section>
            <h3>Consent for testing (Parent/Guardian if child)</h3>
            <table class="section-b">
                <tbody>
                    <tr>
                        <td>
                            <label>Do you agree to have his/her blood drawn for testing?</label>
                            <obs id="br" conceptId="99481" answerConceptIds="1065,1066" answerLabels="Yes,No"/>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section>
            <h3>Reasons given for NOT testing:</h3>
            <table class="section-b">
                <tbody>
                    <tr>
                        <td>
                            <label>No Confidentiality</label>
                        </td>
                        <td>
                            <label>No Benefit</label>
                        </td>
                        <td>
                            <label>Pricked many times</label>
                        </td>
                        <td>
                            <label>Will test after improving</label>
                        </td>
                        <td>
                            <label>No reason</label>
                        </td>
                        <td>
                            <label>Fear of HIV Result</label>
                        </td>
                        <td>
                            <label>Consult Spouse/sexual partner</label>
                        </td>
                        <td>
                            <label>Known HIV Status</label>
                        </td>
                        <td>
                            <label>Not ready for a test</label>
                        </td>
                        <td>
                            <label>Other(Specify)</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <obs conceptId="99482" answerConceptId="1065" answerLabel=""/>
                        </td>
                        <td>
                            <obs conceptId="99483" answerConceptId="1065" answerLabel=""/>
                        </td>
                        <td>
                            <obs conceptId="99484" answerConceptId="1065" answerLabel=""/>
                        </td>
                        <td>
                            <obs conceptId="99485" answerConceptId="1065" answerLabel=""/>
                        </td>
                        <td>
                            <obs conceptId="99486" answerConceptId="1065" answerLabel=""/>
                        </td>
                        <td>
                            <obs conceptId="99487" answerConceptId="1065" answerLabel=""/>

                        </td>
                        <td>
                            <obs conceptId="99488" answerConceptId="1065" answerLabel=""/>
                        </td>
                        <td>
                            <obs conceptId="99489" answerConceptId="1065" answerLabel=""/>
                        </td>
                        <td>
                            <obs conceptId="99490" answerConceptId="1065" answerLabel=""/>

                        </td>
                        <td>
                            <obs conceptId="99491" answerConceptId="1065" answerLabel=""/>
                            <br/>
                            <obs conceptId="99492"/>

                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section>
            <h3>Section C: Test Results</h3>
            <table class="section-b">
                <tbody>
                    <tr>
                        <td><label>HIV final test results:</label>
                            <obs conceptId="99493" answerConceptIds="90167,90166,162926,162927" answerLabels="Negative,Positive,INC,NT"/>
                        </td>
                        <td>
                            <label>Sent to EQA or Confirmatory Laboratory</label>
                            <obs conceptId="162928" answerConceptIds="90004,90003" answerLabels="Yes,No"/>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section>
            <table>
                <tbody>
                    <tr>
                        <td><label>Results Recieved:</label>
                            <obs conceptId="99411" answerConceptIds="1065,1066" answerLabels="Yes,No"/>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Results received as a couple:</label>
                            <obs conceptId="99494" answerConceptIds="1065,1066" answerLabels="Yes,No"/>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Couple results:</label>
                            <obs conceptId="99497" answerConceptIds="6096,99496" answerLabels="Discordant,Cordant"/>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Is there suspision for TB<br/>(Currentcough,fever,weightloss and nightsweats):</label>
                            <obs conceptId="99498" answerConceptIds="1065,1066" answerLabels="Yes,No"/>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Has client started cotrimoxazole prophylaxis:</label>
                            <obs conceptId="99413" answerConceptIds="1065,1066" answerLabels="Yes,No"/>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Has client been linked to care:</label>
                            <obs conceptId="99429" answerConceptIds="1065,1066" answerLabels="Yes,No"/>
                        </td>
                    </tr>
                    <tr>
                        <td><label>CD4 count results if applicable:</label>
                            <obs conceptId="5497"/>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Counsellor</label>
                            <encounterProvider role="Counselor" required="true"  />
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section>
            <submit/>
        </section>
    </div>
    <small>
        <i>
            Version 1.2 Last revised on
            01/December/2015 - Ministry of Health
        </i>
    </small>
</htmlform>